# Karaoke English

## 概要
ブラウザ上で英語スクリプトの音読練習を支援する、音声認識対応カラオケリーダーです。Web Speech API（SpeechRecognition）を利用してマイク入力を解析し、文章内の該当単語をリアルタイムでハイライトします。

## 主な機能
- **iPad を含むモバイル環境で安定したハイライト表示**：ハイライト演出を再設計し、Safari での文字消失を解消しました。
- **超リアルタイム高速モード**：軽量な逐次整列アルゴリズムにより、発話に追従するレスポンスを重視した高速モードを実装。適応的なウィンドウ探索と簡易スコアで即時更新します。
- **ガラスモーフィズムを基調とした UI リフレッシュ**：進行度・レスポンス・安定度の指標パネルやモード／言語ピルを追加し、状況を一目で確認できます。
- **ダーク/ライト切り替え、言語・モード設定、ショートカットキー**などの操作をすべて UI 上で完結。

## 使い方
1. `index.html` をブラウザで開きます（Chrome/Edge 推奨。Safari は SpeechRecognition の仕様上一部制限があります）。
2. 左側のテキスト欄に英文スクリプトを貼り付けるか、`サンプル` ボタンで例文を読み込みます。
3. 右上の設定で認識言語・モード・自動スクロールを調整します。
4. `🎤 開始 (S)` ボタン、またはキーボード `S` キーでマイク入力を開始します。許可ダイアログが表示されたらマイクへのアクセスを許可してください。
5. 読み上げると、該当単語が順次ハイライトされ、進行度バーとレスポンス指標が更新されます。終了する場合は `■ 停止` ボタン、または再度 `S` キーを押します。

## モード説明
- **正確モード**：コンテキストを広く参照し、高精度な整列を優先します。終端結果に基づく巻き戻しや追い付き処理を行います。
- **高速モード**：発話片ごとに動的ウィンドウを探索し、高速にハイライトを進めます。信頼度が下がった場合はロバストな再整列に自動的に切り替え、進捗を補正します。

## リアルタイム指標
- **進行度**：全文に対する読了率を表示します。
- **レスポンス**：最新入力とハイライト確定の差分時間（ms）。高速モード時に更新されます。
- **安定度**：最近のマッチ品質を 0〜100% でスコア化した指標です。

## キーボードショートカット
| キー | 動作 |
| --- | --- |
| `S` | マイク開始/停止 |
| `←` / `→` | 1語戻る / 進む |

## 開発メモ
- 音声認識はブラウザ組み込みの SpeechRecognition を使用しています。対応ブラウザや API の詳細は [MDN Web Docs: Web Speech API](https://developer.mozilla.org/docs/Web/API/Web_Speech_API) を参照してください。
- 主要なスタイルとスクリプトは `index.html` に同梱されています。UI レイアウトの刷新に伴い、`.session-meta`、`.session-status` などの新しいコンポーネントを追加しています。
- 高速モードのリアルタイム整列は `processSpeedRecognition` 関数と `findRealtimeCandidate` ヘルパーで実装されています。スコアリングは `scoreWordMatch` の結果を用いています。

## ライセンス
本リポジトリのライセンスは未指定です。必要に応じて追加してください。
